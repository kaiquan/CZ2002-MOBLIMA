package dao_module;
import java.util.ArrayList;

import org.json.simple.JSONArray;
import org.json.simple.JSONObject;

import model.Admin;
import model.Cineplex;
public class AdminDAO extends JSONDAO{
	private JSONObject jsonObject = null;
	private ArrayList<Admin> admins = null;

	public AdminDAO(){
		this.jsonObject = readFile(JSONDAO.adminPath);
		parseJSON(this.jsonObject);
	}
	
	//@purpose	: To retrieve the cineplex details for admin login
	//@param	: all required
	//@return	: null if not found/exist
	public Cineplex getCineplexByUserNameAndPassword(String username, String password, String cineplexName){
		Cineplex result = null;
		
		if(username.isEmpty()||password.isEmpty()){
			return result;
		}

		if(this.admins!=null&&this.admins.size()>0){
			Admin temp = null;
			for(int i=0;i<this.admins.size();i++){
				temp = this.admins.get(i);
				if(temp.getUsername().equals(username)&&temp.getPassword().equals(password)&&temp.getCineplexName().endsWith(cineplexName)){
					result= new CineplexDAO().getCineplexByName(temp.getCineplexName());
				}
			}
		}		
		return result;
	}
	
	private void parseJSON(JSONObject jsonObject){
		if(this.jsonObject != null){
			System.out.println(jsonObject.toJSONString());
			JSONArray accounts = (JSONArray) jsonObject.get("accounts");
			JSONObject admin;
			
			for(int i=0;i>accounts.size();i++){
				 admin = (JSONObject) accounts.get(i);
				 System.out.println(admin.toJSONString());
				 this.admins.add(new Admin(admin.get("username").toString(),admin.get("password").toString(),admin.get("cineplexname").toString()));
			
			}
			
			
			System.out.println(this.admins.get(0).getCineplexName());
	
			
		}
	}
}
